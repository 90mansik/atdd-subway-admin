## 3주차 ATDD 지하철 노선도

### step1
- 구현된 기능을 대상으로 인수 테스트를 작성하는 단계입니다.
- RestAssured를 활용하여 인수 테스트를 만들어 보세요
- 지하철역 관련 인수 테스트를 완성하세요.
- 지하철역 목록 조회 인수 테스트 작성하기
- 지하철역 삭제 인수 테스트 작성하기

### step2
- 제시된 인수 조건을 기반으로 기능 구현을 하는 단계입니다.
- 기능 구현 전에 인수 조건을 만족하는지 검증하는 인수 테스트를 먼저 만들고 기능구현을 해보세요.
- 아래 내용의 인수테스트, 기능을 작성하세요
- 지하철 노선 생성 
- 지하철 노선 목록 조회
- 지하철 노선 조회
- 지하철 노선 수정
- 지하철 노선 삭제

### step3
- 요구사항 설명에서 제공되는 요구사항을 기반으로 지하철 구간 추가 기능을 구현하세요.
- 요구사항을 정의한 인수 조건을 도출하세요.
- 인수 조건을 검증하는 인수 테스트를 작성하세요.
- 예외 케이스에 대한 검증도 포함하세요.
- 역 사이에 새로운 역을 등록할 경우
- 새로운 역을 하행 종점으로 등록할 경우
- 새로운 역을 하행 종점으로 등록할 경우
- 역 사이에 새로운 역을 등록할 경우 기존 역 사이 길이보다 크거나 같으면 등록을 할 수 없음
- 상행역과 하행역이 이미 노선에 모두 등록되어 있다면 추가할 수 없음
- 상행역과 하행역 둘 중 하나도 포함되어 있지 않으면 추가할 수 없음

### step4
- 종점을 제거하는 경우
- 가운데 역을 제거하는 경우
- 구간이 하나인 노선에서 역을 제거하는 경우

### step1 인수테스트
> - [x] 1.지하철 목록을 조회 한다.
>   - [x] 강남역,역삼역 2개의 역을 생성한다.
>   - [x] 지하철 목록을 조회한다.
>   - [x] 조회된 목록의 사이즈가 2인지 체크한다.
> - [x] 2.지하철역 삭제 한다.
>   - [x] 강남역,역삼역 2개의 역을 생성한다.
>   - [x] 역삼역을 삭제 한다.
>   - [x] 지하철 목록을 조회한다.
>   - [x] 조회된 목록의 사이즈가 1, 역삼역이 목록에 없는지 체크한다.

### step2 인수테스트
> - [x] 1.지하철 노선을 생성한다.
>   - [x] 신분당선 노선을 생성한다.
>   - [x] 정상적으로 응답하는지 확인한다.
> - [x] 2.지하철 노선 목록을 조회한다.
>   - [x] 신분당선, 분당선 2개의 노선을 생성한다.
>   - [x] 노선 목록을 조회 한다.
>   - [x] 조회된 목록 사이즈가 2인지 체크한다.
> - [x] 3.지하철 노선을 조회한다.
>   - [x] 신분당선 노선을 생성한다.
>   - [x] 신분당선의 아이디 값으로 조회한다.
>   - [x] 조회된 응답 값에 이름이 신분당선인지 검증한다.
> - [x] 4.지하철 노선을 수정한다.
>   - [x] 분당선 노선을 생선한다.
>   - [x] 분당선의 이름을 7호선으로 변경한다.
>   - [x] 이름이 7호선으로 변경 되었는지 검증한다.
> - [x] 5.지하철 노선을 삭제한다.
>   - [x] 신분당선 노선을 생성한다.
>   - [x] 신분당선 노선을 삭제한다.
>   - [x] 신분당선 노선 조회 시 조회 되지 않는 것을 검증한다.


### Step2 개선사항
> - [x] 역에 대한 정보가 없을 경우 예외처리
> - [x] Line 도메인에서의 dto의존성 제거
> - [ ] 인수테스트 공통로직 분리

### Step3 인수테스트

> - [x] 1.신규 지하철 구간 생성 
>   - 강남역(상행)-선릉역(하행) 7m 등록한다.   
>   - 신규 지하철 구간 추가 한다. > 강남역(상행)-역삼(하행) 4m
>   - 정상 응답이 오는지 확인(StatusCode = 201) 
> - [x] 2.새로운 역을 상행 종점으로 구간 등록
>   - 역삼역(상행 종점)-선릉역(하행 종점) 7m 등록한다.
>   - 신규 지하철 구간 추가 한다. > 강남역-선릉역 4m 
>   - 정상적으로 구간 생성 되었는지 확인, 교대역(상행 종점)-역삼역-선릉역(하행 종점) 11m
> - [x] 3.새로운 역을 하행 종점으로 등록할 경우
>   - 강남역(상행 종점)-선릉역(하행 종점) 7m 등록한다.
>   - 신규 지하철 구간 추가 한다. > 선릉역-삼성역 4m
>   - 정상적으로 구간 생성 되었는지 확인, 강남역(상행 종점)-선릉역-삼성역(하행 종점)
> - [x] 4.신규 지하철 구간 생성 시 유효성 체크
>   - [x] 4.1 역 사이에 새로운 역 등록 시 기존 역 사이 길이보다 크거나 같으면 등록 불가
>     - 강남역(상행 종점)-선릉역(하행 종점) 7m을 등록한다.
>     - 신규 지하철 구간 추가 한다. > 강남역-역삼역 7m
>     - 에러 메시지 발생 되는지 확인.
>   - [x] 4.2 상행역과 하행역이 이미 노선에 모두 등록되어 있다면 추가 불가
>     - 강남역(상행 종점)-선릉역(하행 종점) 7m을 등록한다.
>     - 신규 지하철 구간 추가 한다. > 강남역-역삼역 7m
>     - 에러 메시지 발생 되는지 확인
>   - [x] 4.3 상행역과 하행역 둘 중 하나도 포함되어 있지 않으면 추가 불가
>     - 강남역(상행 종점)-선릉역(하행 종점) 7m을 등록한다.
>     - 신규 지하철 구간 추가 한다. > 삼성역-종합운동장 7m
>     - 에러 메시지 발생 되는지 확인.

### Step3 개선사항
>   - [x] 예외에 메시지를 담기.
>   - [x] 빼기 검증 리팩토링
>   - [x] 생성자 하나를 주생성자로 만들기.
>   - [x] 사용하지 않는 코드 제거.
>   - [x] 구간 추가 시 재정렬 리팩토링
>   - [x] 인수테스트를 위한 추상클래스 정의
>   - [x] 테스트 독립성을 위한 테스트 분리 

### Step4 개선사항
>   - [ ] 1.종점을 제거하는 경우
>     - [x] 상행 종점 제거
>     - [ ] 하행 종점 제거
>   - [ ] 2.가운데 역을 제거하는 경우
>   - [ ] 3.구간이 하나인 노선에서 역을 제거하는 경우
 



