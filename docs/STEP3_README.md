3단계 - 구간 추가 기능
===

***

## TODO
- 2단계 피드백 반영
  - [X] 클래스 대신 메서드에 @Transactional 선언
  - [X] 접근제어자에 따른 메서드 정렬
  - [X] Exception에 메시지 추가
  - [X] Repository에서 findAll 제거
  - [X] LineService.saveLine 로직 순서 수정
  - [X] Section - Station 연관관계 수정
- 인수 테스트 작성
  - [X] 새로운 역을 상행 종점으로 등록할 경우
  - [X] 새로운 역을 하행 종점으로 등록할 경우
  - [X] 역 사이에 새로운 역을 등록할 경우
- 기능 구현
  - [X] 새로운 역을 상행 종점으로 등록할 경우
  - [X] 새로운 역을 하행 종점으로 등록할 경우
  - 역 사이에 새로운 역을 등록할 경우
    - [X] 새로운 길이를 뺀 나머지를 새롭게 추가된 역과의 길이로 설정
    - [X] 기존 구간 상/하행 역 수정
- 구간 등록 예외 케이스
  - [X] 역 사이에 새로운 역을 등록할 경우 기존 역 사이 길이보다 크거나 같으면 등록을 할 수 없음
  - [X] 상행역과 하행역이 이미 노선에 모두 등록되어 있다면 추가할 수 없음
  - [X] 상행역과 하행역 둘 중 하나도 포함되어있지 않으면 추가할 수 없음
- [X] 인수 테스트 격리
- [X] 인수 테스트 리팩터링

***

## 기능 요구사항
- `요구사항 설명`에서 제공되는 요구사항을 기반으로 **지하철 구간 추가 기능**을 구현하세요.
- 요구사항을 정의한 **인수 조건**을 조출하세요.
- 인수 조건을 검증하는 **인수 테스트**를 작성하세요.
- 예외 케이스에 대한 검증도 포함하세요.

## 프로그래밍 요구사항
- **인수 테스트 주도 개발 프로세스**에 맞춰서 기능을 구현하세요.
  - `요구사항 설명`을 참고하여 인수 조건을 정의
  - 인수 조건을 검증하는 인수 테스트 작성
  - 인수 테스트를 충족하는 기능 구현
- 인수 조건은 인수 테스트 메서드 상단에 주석으로 작성하세요.
  - 뼈대 코드의 인수 테스트를 참고
- 인수 테스트의 결과가 다른 인수 테스트에 영향을 끼치지 않도록 인수 테스트를 서로 격리 시키세요.
- 인수 테스트의 재사용성과 가독성, 그리고 빠른 테스트 의도 파악을 위해 인수 테스트를 리팩터링 하세요.

## 요구사항 설명
### API 명세
구간 등록 API Request
```text
POST /lines/1/sections HTTP/1.1
accept: */*
content-type: application/json; charset=UTF-8
host: localhost:52165

{
    "downStationId": "4",
    "upStationId": "2",
    "distance": 10
}
```
### 지하철 구간 등록 인수 테스트 작성과 기능 구현
- 역 사이에 새로운 역을 등록할 경우
  - 새로운 길이를 뺀 나머지를 새롭게 추가된 역과의 길이로 설정
- 새로운 역을 상행 종점으로 등록할 경우
- 새로운 역을 하행 종점으로 등록할 경우
- 구간 등록 시 예외 케이스를 고려하기
  - 역 사이에 새로운 역을 등록할 경우 기존 역 사이 길이보다 크거나 같으면 등록을 할 수 없음
- 상행역과 하행역이 이미 노선에 모두 등록되어 있다면 추가할 수 없음
  - 아래의 이미지 에서 A-B, B-C 구간이 등록된 상황에서 B-C 구간을 등록할 수 없음(A-C 구간도 등록할 수 없음)
- 상행역과 하행역 둘 중 하나도 포함되어있지 않으면 추가할 수 없음
